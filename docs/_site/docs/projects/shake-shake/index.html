<!doctype html>

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Shake, Shake - IoT Developer Kits</title>




<meta name="description" content="Use the motion sensor to detect shaking, and use a simple Azure Functions app to find a random tweet with a #hashtag.">




<meta name="author" content="MXChip IoT Developer Kit">

<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="IoT Developer Kits">
<meta property="og:title" content="Shake, Shake">


  <link rel="canonical" href="http://localhost:4000/azure-iot-developer-kit/docs/projects/shake-shake/">
  <meta property="og:url" content="http://localhost:4000/azure-iot-developer-kit/docs/projects/shake-shake/">



  <meta property="og:description" content="Use the motion sensor to detect shaking, and use a simple Azure Functions app to find a random tweet with a #hashtag.">





  

  



  <meta property="og:image" content="http://localhost:4000/azure-iot-developer-kit/assets/images/foo-bar-identity.jpg">



  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-05-05T22:17:51-07:00">






  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "http://localhost:4000/azure-iot-developer-kit",
      "logo": "http://localhost:4000/azure-iot-developer-kit/assets/images/site-logo.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "MXChip IoT Developer Kit",
      "url" : "http://localhost:4000/azure-iot-developer-kit",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/azure-iot-developer-kit/feed.xml" type="application/atom+xml" rel="alternate" title="IoT Developer Kits Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/azure-iot-developer-kit/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/azure-iot-developer-kit/">IoT Developer Kits</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/azure-iot-developer-kit/docs/getting-started/">Docs</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/azure-iot-developer-kit/versions/">Versions</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blogs.msdn.microsoft.com/iotdev/">Blog</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    
  





<div class="page__hero"
  style="  "
>
  
    <img src="http://localhost:4000/azure-iot-developer-kit/assets/images/foo-bar-identity.jpg" alt="Shake, Shake" class="page__hero-image">
  
  
</div>





<div id="main" role="main">
  

  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Shake, Shake">
    <meta itemprop="description" content="Use the motion sensor to detect shaking, and use a simple Azure Functions app to find a random tweet with a #hashtag.">
    <meta itemprop="datePublished" content="May 05, 2017">
    <meta itemprop="dateModified" content="April 30, 2017">

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Shake, Shake
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p>In this project, you will learn how to use the motion sensor to trigger an event using Azure Functions. The app will retrieve a random tweet with a #hashtag you have configured in your Arduino sketch. The tweet will display on the DevKit screen, and every time you shake the DevKit board, you will get a new tweet.</p>

<h2 id="what-you-need">What you need</h2>

<ul>
  <li>Finish the <a href="http://localhost:4000/azure-iot-developer-kit/docs/getting-started/">Getting Started Guide</a></li>
</ul>

<h2 id="step-1-open-arduino-examples-folder">Step 1. Open Arduino Examples folder</h2>

<p>In VS Code, use <code class="highlighter-rouge">Ctrl+Shift+P</code> to invoke command palette and type <strong>Arduino</strong> then find and select <strong>Arduino: Examples</strong> to open example pane. Navigate to <code class="highlighter-rouge">Examples for MXChip AZ3166 &gt; AzureIoTHub</code> and click on <code class="highlighter-rouge">AzureIoTHubExample</code>.</p>

<h2 id="step-2-provision-azure-services">Step 2. Provision Azure services</h2>

<p>In the solution window, run your task through <strong>Quick Open</strong> (<code class="highlighter-rouge">Ctrl+P</code>) by typing ‘task provision’:</p>

<p>In the VS Code terminal, an interactive command line will guide you through provisioning the required Azure services:</p>

<p><img src="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-provision-sub.png" alt="mini-solution-provision-sub" /></p>

<h2 id="step-3-modify-the-hashtag">Step 3. Modify the #hashtag</h2>

<p>Open <code class="highlighter-rouge">AzureIotHubExample.ino</code> and look for the line of code:</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">iot_event</span> <span class="o">=</span> <span class="s">"{</span><span class="se">\"</span><span class="s">topic</span><span class="se">\"</span><span class="s">:</span><span class="se">\"</span><span class="s">iot</span><span class="se">\"</span><span class="s">}"</span><span class="p">;</span>
</code></pre>
</div>

<p>Replace the string <code class="highlighter-rouge">iot</code> in the curly brace with your preferred hashtag.</p>

<h2 id="step-4-deploy-your-solution">Step 4. Deploy your solution</h2>

<p>Build and deploy Arduino code as well as an Azure Functions app.</p>

<ol>
  <li>Use <strong>Quick Open</strong> (<code class="highlighter-rouge">Ctrl+P</code>) to run ‘task deploy’. It will start deploying the Azure Functions code. Normally it takes 2 to 5 minutes to finish.</li>
  <li>Use <strong>Quick Open</strong> (<code class="highlighter-rouge">Ctrl+P</code>) to run ‘task build’. The terminal will prompt you to enter configuration mode again. This is to set the connection string. It will build the Arduino code and upload it to the device. The DevKit will reboot and start running the code:</li>
</ol>

<h2 id="step-5-test-the-solution">Step 5. Test the solution</h2>

<p>After app initialization, click button A and mildly shake the board to retrieve a random tweet with your hashtag (e.g. #build2017). A tweet will display on your screen in a few seconds:</p>

<figure class="third ">
  
    
      <a href="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-shake-shake-1.jpg">
        <img src="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-shake-shake-1.jpg" alt="Arduino application initializing" />
      </a>
    
  
    
      <a href="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-shake-shake-2.jpg">
        <img src="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-shake-shake-2.jpg" alt="Ready to shake" />
      </a>
    
  
    
      <a href="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-shake-shake-3.jpg">
        <img src="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-shake-shake-3.jpg" alt="Display a random tweet" />
      </a>
    
  
  
    <figcaption>Shake, shake for a random tweet with #hashtag you set in the code.
</figcaption>
  
</figure>

<ul>
  <li>Press button A again, then shake for a new tweet.</li>
  <li>Press button B to scroll through the rest of the tweet.</li>
</ul>

<h2 id="how-it-works">How it works</h2>

<p><img src="http://localhost:4000/azure-iot-developer-kit/assets/images/mini-solution-diagram-shake-shake.png" alt="mini-solution-voice-to-tweet-diagram" /></p>

<p>The Arduino sketch sends an event to Azure IoT Hub which triggers the Azure Functions app. Azure Functions contains the logic to connect to Twitter’s API and retrieve a tweet. It wraps the tweet text into a C2D (Cloud-to-device) message and sends it back to the device.</p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-04-30">April 30, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Shake, Shake http://localhost:4000/azure-iot-developer-kit/docs/projects/shake-shake/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/azure-iot-developer-kit/docs/projects/shake-shake/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/azure-iot-developer-kit/docs/projects/shake-shake/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="#" class="pagination--pager disabled">Previous</a>
    
    
      <a href="http://localhost:4000/azure-iot-developer-kit/docs/projects/" class="pagination--pager" title="Your Ideas?
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
          <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/Microsoft/azure-iot-developer-kit"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/azure-iot-developer-kit/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">Copyright &copy; 2017 Microsoft Corp.</div>
      </footer>
    </div>

    <script src="http://localhost:4000/azure-iot-developer-kit/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98097460-1', 'auto');
  ga('send', 'pageview');
</script>







  </body>
</html>
